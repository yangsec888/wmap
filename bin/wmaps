#!/usr/bin/env ruby
# script to automate the new site discovery through by crawling all unique sites in the site store
require "wmap"
require "parallel"

def wmap_worker(domain)
   cmd = "wmap " + domain
   puts "wmap discovery on domain: ", domain
   system(cmd)
end


tracker=Wmap::DomainTracker.new
=begin
Parallel.map(tracker.known_internet_domains.keys, :in_processes => 10) { |target|
  puts "Working on #{target} ..." if @verbose
  wmap_worker(target)
}
=end
tracker.known_internet_domains.keys.map do |domain|
  wmap_worker(domain)
end

tracker=nil
